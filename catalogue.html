<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <title>Jewls London - Catalogue</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Header -->
    <header id="header">
      <div class="container header-container">
        <a href="index.html#home" class="logo">Jewls <span>London</span></a>
        <nav>
          <ul class="nav-menu">
            <li><a href="index.html#home">Home</a></li>
            <li><a href="index.html#about">About</a></li>
            <li><a href="index.html#collection">Collection</a></li>
            <li><a href="index.html#contact">Contact</a></li>
            <li><a href="catalogue.html">Catalogue</a></li>
          </ul>
          <div class="hamburger">
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>
          </div>
        </nav>
      </div>
    </header>

    <!-- Catalogue Section -->
    <section
      id="catalogue-page"
      class="collection section"
      style="padding-top: 120px"
    >
      <!-- Added padding-top to avoid overlap with fixed header -->
      <div class="container">
        <div class="section-title">
          <h2>Our Full Catalogue</h2>
        </div>
        <div class="collection-grid" id="catalogueGrid">
          <!-- Products will be dynamically inserted here by JavaScript -->
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-container">
          <div class="footer-about">
            <div class="footer-logo">Jewls <span>London</span></div>
            <p>
              Jewls London creates exquisite jewellery pieces that blend
              timeless elegance with contemporary design. Each creation
              represents the pinnacle of luxury craftsmanship.
            </p>
            <div class="social-links">
              <a href="#" class="social-link"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="#" class="social-link"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
              <a href="#" class="social-link"
                ><i class="fab fa-pinterest-p"></i
              ></a>
            </div>
          </div>
          <div class="footer-links">
            <h3 class="footer-title">Quick Links</h3>
            <ul>
              <li><a href="index.html#home">Home</a></li>
              <li><a href="index.html#about">About Us</a></li>
              <li><a href="index.html#collection">Collection</a></li>
              <li><a href="index.html#contact">Contact</a></li>
              <li><a href="catalogue.html">Catalogue</a></li>
            </ul>
          </div>
          <div class="footer-newsletter">
            <h3 class="footer-title">Newsletter</h3>
            <p>
              Subscribe to receive updates on new collections and exclusive
              offers.
            </p>
            <form class="newsletter-form" id="catalogueNewsletterForm">
              <div class="form-group">
                <input
                  type="email"
                  class="form-control"
                  placeholder="Your Email"
                  required
                />
              </div>
              <button type="submit" class="btn">Subscribe</button>
            </form>
          </div>
        </div>
        <div class="copyright">
          <p>© 2025 Jewls London. All Rights Reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Product Modal -->
    <div class="modal" id="productModal">
      <div class="modal-content">
        <span class="modal-close"><i class="fas fa-times"></i></span>
        <div class="modal-body">
          <div class="modal-image">
            <img
              src="https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?w=600&h=800&fit=crop&crop=center"
              alt="Product"
              id="modalImage"
            />
          </div>
          <div class="modal-info">
            <div class="modal-category" id="modalCategory">Category</div>
            <h2 class="modal-title" id="modalTitle">Product Title</h2>
            <div class="modal-price" id="modalPrice">£0</div>
            <div class="modal-description" id="modalDescription">
              <!-- Description will be populated by JS -->
            </div>
            <div class="modal-actions">
              <button class="btn" id="modalAddToCartBtn">Add to Cart</button>
              <button class="btn" id="modalBookAppointmentBtn">
                Book Appointment
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Mobile detection and optimization
        const isMobile =
          /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
            navigator.userAgent
          );

        // Navigation Menu Toggle with improved mobile handling
        const hamburger = document.querySelector(".hamburger");
        const navMenu = document.querySelector(".nav-menu");
        const body = document.body;

        if (hamburger && navMenu) {
          hamburger.addEventListener("click", (e) => {
            e.preventDefault();
            hamburger.classList.toggle("active");
            navMenu.classList.toggle("active");

            // Prevent body scroll when menu is open on mobile
            if (navMenu.classList.contains("active")) {
              body.style.overflow = "hidden";
            } else {
              body.style.overflow = "auto";
            }
          });

          document.querySelectorAll(".nav-menu a").forEach((link) => {
            link.addEventListener("click", () => {
              // Close menu if it's an internal link or points to index.html sections
              const href = link.getAttribute("href");
              if (
                href &&
                (href.startsWith("index.html#") ||
                  href === "catalogue.html" ||
                  href.startsWith("#"))
              ) {
                if (navMenu.classList.contains("active")) {
                  // Only close if active
                  hamburger.classList.remove("active");
                  navMenu.classList.remove("active");
                  body.style.overflow = "auto";
                }
              }
            });
          });

          // Close menu when clicking outside on mobile
          document.addEventListener("click", (e) => {
            if (
              window.innerWidth <= 768 &&
              !hamburger.contains(e.target) &&
              !navMenu.contains(e.target) &&
              navMenu.classList.contains("active")
            ) {
              hamburger.classList.remove("active");
              navMenu.classList.remove("active");
              body.style.overflow = "auto";
            }
          });
        }

        // Header Scroll Effect
        const header = document.getElementById("header");
        if (header) {
          window.addEventListener("scroll", () => {
            if (window.scrollY > 50) {
              header.style.padding = "5px 0";
              header.style.boxShadow = "0 2px 10px rgba(0, 0, 0, 0.1)";
            } else {
              header.style.padding = "10px 0"; // Adjusted to match initial padding in CSS
              header.style.boxShadow = "none";
            }
          });
        }

        // Product Data - Load from JSON file
        let products = [];

        // Fetch products from JSON file
        async function loadProducts() {
          try {
            const response = await fetch("products.json");
            const data = await response.json();
            products = data.products;
            displayProducts();
          } catch (error) {
            console.error("Error loading products:", error);
            // Fallback to empty array if JSON fails to load
            products = [];
          }
        }

        // Product Modal Elements
        const modal = document.getElementById("productModal");
        const modalClose = document.querySelector(".modal-close");
        const modalImage = document.getElementById("modalImage");
        const modalCategory = document.getElementById("modalCategory");
        const modalTitle = document.getElementById("modalTitle");
        const modalPrice = document.getElementById("modalPrice");
        const modalDescriptionElem =
          document.getElementById("modalDescription");
        const modalAddToCartBtn = document.getElementById("modalAddToCartBtn");
        const modalBookAppointmentBtn = document.getElementById(
          "modalBookAppointmentBtn"
        );

        const catalogueGrid = document.getElementById("catalogueGrid");

        function displayProducts() {
          if (!catalogueGrid) return;
          products.forEach((product) => {
            const item = document.createElement("div");
            item.classList.add("collection-item");
            item.setAttribute("data-id", product.id);
            item.innerHTML = `
                <img src="${product.image}" alt="${product.title}" />
                <div class="collection-overlay">
                    <h3>${product.title}</h3>
                    <p>${product.category}</p>
                    <div class="collection-price">${product.price}</div>
                </div>
            `;

            // Improved touch handling for mobile
            let touchStartTime = 0;

            item.addEventListener("touchstart", () => {
              touchStartTime = Date.now();
            });

            item.addEventListener("touchend", (e) => {
              const touchDuration = Date.now() - touchStartTime;
              if (touchDuration < 500) {
                // Quick tap
                e.preventDefault();
                openModalWithProduct(product.id);
              }
            });

            // Keep click handler for desktop
            item.addEventListener("click", () => {
              if (!isMobile) {
                openModalWithProduct(product.id);
              }
            });

            catalogueGrid.appendChild(item);
          });
        }

        function openModalWithProduct(productId) {
          const product = products.find((p) => p.id === productId);
          if (
            product &&
            modal &&
            modalImage &&
            modalCategory &&
            modalTitle &&
            modalPrice &&
            modalDescriptionElem
          ) {
            modalImage.src = product.image;
            modalCategory.textContent = product.category;
            modalTitle.textContent = product.title;
            modalPrice.textContent = product.price;
            modalDescriptionElem.innerHTML = `<p>${product.description}</p>
                <p>Each Jewls piece comes beautifully presented in our signature packaging with a certificate of authenticity and a complimentary first cleaning and inspection service.</p>`;

            if (modalAddToCartBtn) {
              modalAddToCartBtn.onclick = () => {
                alert(
                  `Adding "${product.title}" to cart is a planned feature!`
                );
              };
            }
            if (modalBookAppointmentBtn) {
              modalBookAppointmentBtn.onclick = () => {
                alert(
                  `To book an appointment regarding "${product.title}", please use the contact form or call us. Online booking coming soon!`
                );
              };
            }

            modal.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        }

        if (modalClose && modal) {
          modalClose.addEventListener("click", () => {
            modal.classList.remove("active");
            document.body.style.overflow = "auto";
          });
        }

        if (modal) {
          window.addEventListener("click", (e) => {
            if (e.target === modal) {
              modal.classList.remove("active");
              document.body.style.overflow = "auto";
            }
          });
        }

        // Load products when page loads
        loadProducts();

        // Newsletter Form Submission for Catalogue Page
        const catalogueNewsletterForm = document.getElementById(
          "catalogueNewsletterForm"
        );
        if (catalogueNewsletterForm) {
          catalogueNewsletterForm.addEventListener("submit", (e) => {
            e.preventDefault();

            // Mobile-friendly success message
            if (isMobile) {
              const notification = document.createElement("div");
              notification.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: var(--gold);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    z-index: 10000;
                    text-align: center;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                  `;
              notification.textContent = "Thank you for subscribing!";
              document.body.appendChild(notification);

              setTimeout(() => {
                document.body.removeChild(notification);
              }, 3000);
            } else {
              alert("Thank you for subscribing to our newsletter.");
            }

            catalogueNewsletterForm.reset();
          });
        }

        // Handle orientation change
        window.addEventListener("orientationchange", () => {
          setTimeout(() => {
            // Close mobile menu on orientation change
            if (navMenu && navMenu.classList.contains("active")) {
              hamburger.classList.remove("active");
              navMenu.classList.remove("active");
              body.style.overflow = "auto";
            }

            // Close modal on orientation change for better UX
            if (modal && modal.classList.contains("active")) {
              modal.classList.remove("active");
              document.body.style.overflow = "auto";
            }
          }, 100);
        });

        // Smooth scrolling optimization for mobile
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute("href"));
            if (target) {
              const headerHeight =
                document.getElementById("header").offsetHeight;
              const targetPosition = target.offsetTop - headerHeight - 20;

              window.scrollTo({
                top: targetPosition,
                behavior: "smooth",
              });
            }
          });
        });
      });
    </script>
  </body>
</html>
